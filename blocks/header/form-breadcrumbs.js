import{windowUrlDetails}from"../../scripts/tools.js";let loopThroughItems=(r,l)=>{let n=l;for(var i=[];0<n.length;){var a,u=n.join("/");let t="";for(let e=0;e<r.length;e+=1)if(a=r[e]||null,t="/"===a?.getAttribute("href").charAt(0)?a?.href||"":a?.getAttribute("href")||"","#"!==a?.getAttribute("href").charAt(0)&&0<t.length&&u===new URL(t).pathname.split("/").filter(e=>e).join("/")){a.classList.add("siteheader-active-nav"),i.push({current:n.join("/").length===l.join("/").length,el:a,link:a.href,title:a.innerText||a.textContent});break}n=n.slice(0,-1)}return i},buildCrumbs=()=>{let r=[];var t=windowUrlDetails,e=t.pathname,l=e.split("/").filter(e=>e),e=-1<l.indexOf("blue")||-1<e.indexOf("blue-at-work");let n;var i=document.querySelector("footer");if(1<l.length&&e?(n=document.querySelector(".siteheader-blog .siteheader-blog-menu > ul"),r.push({current:!1,title:-1<l.indexOf("blue")?"Blue":"Blue@Work",link:document.querySelector(".siteheader-blog-logo-img > a")?.href})):0<l.length&&!e&&(n=document.querySelector(".siteheader-mobile-wrapper nav > ul"),r.push({current:!1,link:"/",title:"Home"})),n){l=t.pathname.split("/").filter(e=>e);let e=[];return 0===(e=0<l.length?loopThroughItems(Array.from(n.querySelectorAll("a")),l):e).length&&(e=loopThroughItems(Array.from(i.querySelectorAll("a")),l)),[...r,...e.filter(t=>!r.some(e=>e.title===t.title)).sort((e,t)=>e.link.length-t.link.length)]}return[]},uniqueByLink=e=>{let t=new Set;return e.filter(e=>!t.has(e.link)&&(t.add(e.link),!0))},formBreadcrumbs=()=>{var e,t=document.createElement("nav");t.className="breadcrumbs",t.setAttribute("aria-label","Breadcrumb");let i=buildCrumbs();if(!i.find(e=>e.current)){let e=(document.querySelector('meta[name="page-title"]')?.content||"").trim();0===e.length&&(e=document.querySelector("h1")?.innerHTML||""),i.push({current:!0,title:e||"",link:"#"})}let a=document.createElement("ol");(i=JSON.parse(JSON.stringify(uniqueByLink(i)))).forEach((e,t)=>{var r=document.createElement("li"),l=document.createElement("a");l.innerHTML=e.title,l.href=e.link,e.current&&(l.setAttribute("aria-current","page"),l.setAttribute("tabindex",-1),r.setAttribute("aria-hidden","true"));let n;(n=document.createElement("span")).innerHTML='<i class="fa-regular fa-chevron-left"></i>',n.className="breadcrumbs-prev",t===i.length-2&&(r.className="breacrumbs-mobile"),r.appendChild(n),r.appendChild(l),t<i.length-1&&((n=document.createElement("span")).innerHTML='<i class="fa-regular fa-chevron-right"></i>',n.className="breadcrumbs-next",r.appendChild(n)),a.append(r)}),[!0,"true"].includes(document.querySelector('meta[name="breadcrumbs"]')?.content)&&(t.append(a),(e=document.querySelector("main")).querySelector(".siteheader-blog")?e.insertBefore(t,e.firstChild.nextSibling):e.insertBefore(t,e.firstChild))};export default formBreadcrumbs;