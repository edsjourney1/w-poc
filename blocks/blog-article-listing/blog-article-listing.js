import{renderImages}from"../../scripts/externalImage.js";import{excelDateToDate}from"../../scripts/tools.js";export default async function decorate(v){let t,n;var e=await(await fetch("/query-index.json")).json();let E;"category"===v.children[2].children[0].innerText.trim().toLowerCase()&&(t=v.children[2].children[1].innerText,E=e.data.filter(e=>e.category.toLowerCase().includes(t.toLowerCase()))),"tag"===v.children[2].children[0].innerText.trim().toLowerCase()&&(n=v.children[2].children[1].innerText,E=e.data.filter(e=>e.tags.toLowerCase().includes(n.toLowerCase())));e=v.children[0].children[0].innerText;let C=Number(v.children[1].children[0].innerText);var a=v.children[0].children[1].innerHTML,d=(v.innerHTML="",document.createElement("h2")),i=(d.classList.add("title"),document.createElement("span")),a=(i.classList.add("text-icon"),i.innerHTML=a,d.append(e),document.createElement("div"));a.classList.add("heading-div"),a.append(d,i);let m=document.createElement("div");m.classList.add("cards-div");e=document.createElement("div"),e.classList.add("pagination"),d=document.createElement("div");d.classList.add("pagination-container");let l=document.createElement("div"),f=(l.classList.add("count-list"),document.createElement("div")),b=(f.classList.add("count-result"),d.append(l,f),e.append(d),v.append(a,m,e),1);function g(){m.innerHTML="";var e=(b-1)*C,t=e+C,n=(E.slice(e,t).sort((e,t)=>new Date(e.publishedDate?.split("/").reverse().join("/"))-new Date(t.publishedDate?.split("/").reverse().join("/"))).forEach(({image:e,tags:t,publishedDate:n,readTime:a,title:d,url:i,segment:l})=>{var r=document.createElement("div"),i=(r.classList.add("card-div"),new URL(i).pathname),c=document.createElement("div"),o=(c.classList.add("image-div"),document.createElement("a")),e=e.split("#"),s=(c.append(o),document.createElement("p")),e=(o.href=e[0],s.append(o),document.createElement("em")),o=document.createElement("a"),o=(o.href=i+`#${d}-thumbnail`,e.append(o),s.append(e),c.append(s),renderImages(c),r.appendChild(c),document.createElement("div")),e=(o.classList.add("content-div"),r.appendChild(o),document.createElement("h3")),s=document.createElement("a"),c=(e.classList.add("card-title"),s.innerHTML=d,e.append(s),s.href=""+i,o.appendChild(e),document.createElement("div")),d=(c.classList.add("date-div"),o.appendChild(c),document.createElement("p")),s=(d.classList.add("date"),d.textContent=n.includes("/")?n:excelDateToDate(n),""!==n&&c.appendChild(d),document.createElement("p"));s.classList.add("read-time"),s.textContent=a+" min read",""!==a&&c.appendChild(s);let p=document.createElement("p");p.classList.add("category-list"),o.appendChild(p),t.split(",").forEach(e=>{var t=document.createElement("a"),n=`/${l}/tags/`+e.trim().toLowerCase().replaceAll(" ","-").replaceAll("'","");t.href=window.location.origin+n,t.textContent=e.trim(),t.title=e.trim(),p.appendChild(t)}),m.appendChild(r)}),l.innerHTML="",document.createElement("p")),n=(n.textContent="Showing",l.appendChild(n),document.createElement("span")),e=(n.textContent=1+e+" - "+Math.min(t,E.length),l.appendChild(n),document.createElement("p")),t=(e.textContent="of",l.appendChild(e),document.createElement("span"));t.textContent=E.length,l.appendChild(t)}(10<E.length?function a(){let t=Math.ceil(E.length/C);function n(e,t){var n=document.createElement("button");return n.textContent=e,n.addEventListener("click",()=>{b=t,g(),a(),window.scrollTo({top:0,behavior:"smooth"})}),t===b&&n.classList.add("active"),n}function e(){var e=document.createElement("button");return e.textContent="...",e.disabled=!0,e}f.innerHTML="";let d=document.createElement("p"),i=(d.innerHTML='<i class="fa-regular fa-chevrons-left"></i>',d.tabIndex=0,d.role="button",d.ariaLabel="Go to first page",d.addEventListener("click",()=>{b=1,g(),a(),window.scrollTo({top:0,behavior:"smooth"})}),d.addEventListener("keydown",e=>{"Enter"===e.key&&d.click()}),f.appendChild(d),document.createElement("p"));if(i.innerHTML='<i class="fa-regular fa-chevron-left"></i>',i.tabIndex=0,i.role="button",i.ariaLabel="Go to previous page",i.addEventListener("click",()=>{1<b&&(--b,g(),a(),window.scrollTo({top:0,behavior:"smooth"}))}),i.addEventListener("keydown",e=>{"Enter"===e.key&&i.click()}),f.appendChild(i),t<=5)for(let e=1;e<=t;e+=1)f.appendChild(n(e,e));else if(b<=3){for(let e=1;e<=3;e+=1)f.appendChild(n(e,e));f.appendChild(e()),f.appendChild(n(t,t))}else if(b>=t-2){f.appendChild(n(1,1)),f.appendChild(e());for(let e=t-2;e<=t;e+=1)f.appendChild(n(e,e))}else{f.appendChild(n(1,1)),f.appendChild(e());for(let e=b-1;e<=b+1;e+=1)f.appendChild(n(e,e));f.appendChild(e()),f.appendChild(n(t,t))}let l=document.createElement("p"),r=(l.innerHTML='<i class="fa-regular fa-chevron-right"></i>',l.tabIndex=0,l.role="button",l.ariaLabel="Go to next page",l.addEventListener("click",()=>{b<t&&(b+=1,g(),a(),window.scrollTo({top:0,behavior:"smooth"}))}),l.addEventListener("keydown",e=>{"Enter"===e.key&&l.click()}),f.appendChild(l),document.createElement("p"));r.innerHTML='<i class="fa-regular fa-chevrons-right"></i>',r.tabIndex=0,r.role="button",r.ariaLabel="Go to last page",r.addEventListener("click",()=>{b=t,g(),a(),window.scrollTo({top:0,behavior:"smooth"})}),f.appendChild(r),r.addEventListener("keydown",e=>{"Enter"===e.key&&r.click()}),g();var c=v.querySelector(".count-result p i.fa-chevrons-left").parentElement,o=v.querySelector(".count-result p i.fa-chevrons-right").parentElement,s=v.querySelector(".count-result p i.fa-chevron-left").parentElement,p=v.querySelector(".count-result p i.fa-chevron-right").parentElement,m=v.querySelector(".count-result button"),u=v.querySelectorAll(".count-result button"),h=v.querySelector(".count-result button:last-of-type"),L=u[1],u=u[u.length-2];m.classList.contains("active")?(s.classList.add("dp-blur"),s.tabIndex=-1):(s.classList.remove("dp-blur"),s.tabIndex=0),m.classList.contains("active")||L.classList.contains("active")?(c.classList.add("dp-none"),c.tabIndex=-1):(c.classList.remove("dp-none"),c.tabIndex=0),h.classList.contains("active")?(p.classList.add("dp-blur"),p.tabIndex=-1):(p.classList.remove("dp-blur"),p.tabIndex=0),h.classList.contains("active")||u.classList.contains("active")?(o.classList.add("dp-none"),o.tabIndex=-1):(o.classList.remove("dp-none"),o.tabIndex=0)}:g)()}